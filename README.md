# –§–∏–Ω–∞–ª—å–Ω–∞—è –∏—Ç–æ–≥–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ DE
<!-- –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è -->
<!--–ë–ª–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤ –±–µ–π–¥–∂–∞—Ö-->
![Python Version](https://img.shields.io/badge/python-3.13-blue)
## ***–û–ø–∏—Å–∞–Ω–∏–µ***
- –í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PySpark, Clickhouse, PostgreSQL –∏ Ariflow.
- –û—Ç–¥–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—Ä–∞–∑ airflow-with-java –∏–∑ DockerFile (Airflow –∏ PySpark)
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –∏–∑ docker-comose.yml
- –§–∞–π–ª ```russian_houses.csv``` –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ –≤–Ω–µ—à–Ω–µ–π —Å—Å—ã–ª–∫–µ https://disk.yandex.ru/d/HZ08UBRlxoCJTg

–í –ø—Ä–æ–µ–∫—Ç–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏:
	1) –í—ã–≤–æ–¥ –≤–µ—Ä—Å–∏–π Clickhouse –∏ PostgreSQL –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
	2) –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ 
	3) –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞ –≤ DataFrame
	4) –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö
	5) –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ DataFrame –±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤ –ø–æ –≥–æ–¥—É
	6) –í—ã—á–∏—Å–ª–µ–Ω–∏–µ  —Å—Ä–µ–¥–Ω–µ–≥–æ –∏ –º–µ–¥–∏–∞–Ω–Ω–æ–≥–æ –≥–æ–¥–∞ –∑–¥–∞–Ω–∏–π
	7) –í—ã–≤–æ–¥ —Ç–æ–ø-10 —Ä–µ–≥–∏–æ–Ω–æ–≤(–≥–æ—Ä–æ–¥–æ–≤) —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ–±—ä–µ–∫—Ç–æ–≤
	8) –ü–æ–∏—Å–∫ –∑–¥–∞–Ω–∏–π —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥—å—é –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞
	9) –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–¥–∞–Ω–∏–π –ø–æ –¥–µ—Å—è—Ç–∏–ª–µ—Ç—è–º  (1960-—Ö, 1970-—Ö –∏ —Ç.–¥.)
	10) –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞ –≤ Clickhouse (ENGINE=MergeTree)
	11) –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ DataFrame –≤ —Ç–∞–±–ª–∏—Ü—É Clickhouse
	12) –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ø 25 –¥–æ–º–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø–ª–æ—â–∞–¥—å –±–æ–ª—å—à–µ 60 –∫–≤.–º.
	
–ì—Ä–∞—Ñ –≤ Airflow –∏—Å–ø–æ–ª–Ω–µ–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥–µ: 
			```  task_query_clickhouse  >>   task_query_postgres   >> task_load_csvfile >> task_csvetl```
		     ```–í—ã–≤–æ–¥ –≤–µ—Ä—Å–∏–∏ Clickhouse >> –í—ã–≤–æ–¥ –≤–µ—Ä—Å–∏–∏ PostgreSQL >>   –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞  >> –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞```

## ***üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞***

### <u>1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</u>

```git remote add origin git@github.com:nimeroff/FinalTaskBuildings.git```

### <u>2. –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é DomovoyBotTG</u>

```cd FinalTaskBuildings```

### <u>3. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è</u>

```python3 -m venv venv```

### <u>4. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è</u>

```source venv/bin/activate```

### <u>5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</u>

```pip3 install -r requirements.txt```

### <u>6. –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –≤ airflow</u>

```dags main - dags/main.py```

<!--–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏-->
## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–≠—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ Python –≤–µ—Ä—Å–∏–∏ Python 3.13.2 –∏–ª–∏ –≤—ã—à–µ, PIP 25.1.1 –∏–ª–∏ –≤—ã—à–µ.

<!--–æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–æ–≤-->
## –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–æ–≤
| –ù–∞–∑–≤–∞–Ω–∏–µ                                         | –û–ø–∏—Å–∞–Ω–∏–µ                                                                              |
|--------------------------------------------------|---------------------------------------------------------------------------------------|
| Add function load_file and etl_CSV               | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ –∏ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á–∏ airflow              |
| Modified task BashOperator, add link to file csv | –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ bash –≤ —Ä–∞–º–∫–∞—Ö task                              |
| Add 'print top 25 house' to last task            | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è "–¢–æ–ø 25 –¥–æ–º–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø–ª–æ—â–∞–¥—å –±–æ–ª—å—à–µ 60" –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–¥–∞—á–∏ |
| Update REadme.md                                 | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ README.md                                                                  | 
| Add new script min max square                    | –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –Ω–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –≤—ã–≤–æ–¥–∞ –∑–¥–∞–Ω–∏–π —Å –º–∞–∫—Å. –∏ –º–∏–Ω. –ø–ª–æ—â–∞–¥—å—é –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º, –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–µ–Ω—å—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ, —Å—Ç–∞—Ä—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–∫–æ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω |
| Modified srcipt '–¢–æ–ø 10 —Ä–µ–≥–∏–æ–Ω–æ–≤ —Å –Ω–∞–∏–±. –∫–æ–ª. –æ–±—ä–µ–∫—Ç–æ–≤', –≤—ã–±–æ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –∏–∑ df_filter –∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ df_topten | df_filter - –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤ |
| –£–±—Ä–∞–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ jar –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è PSTGRSQL –∏–∑ Dockerfile, –¥–æ–±–∞–≤–ª–µ–Ω–∞ matplotlib==3.10.3 –≤ requirements.txt | –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–∞ –¥–ª—è –¥–æ—Å—Å—Ç—É–ø–∞ –∫ PostrgreSQL –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è |
| Add create table topregion,minax_square_by_region_house, cnt_house_by_ten_years and download data from dataframes | –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –≤ Clickhouse |
| Add function Diag. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –ø–æ 10 —Ä–µ–≥–∏–æ–Ω–∞–º —Å –Ω–∞–∏–± –∫–æ–ª. –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –ª–∏–Ω–µ–π–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è–º' | –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ png, –ø—É—Ç—å - /opt/airflow/dags/ |

    

    

