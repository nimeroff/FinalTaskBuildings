# –§–∏–Ω–∞–ª—å–Ω–∞—è –∏—Ç–æ–≥–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ DE
<!-- –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è -->
<!--–ë–ª–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤ –±–µ–π–¥–∂–∞—Ö-->
![Python Version](https://img.shields.io/badge/python-3.13-blue)
<!--–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏-->
### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–≠—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ Python –≤–µ—Ä—Å–∏–∏ Python 3.13.2 –∏–ª–∏ –≤—ã—à–µ, PIP 25.1.1 –∏–ª–∏ –≤—ã—à–µ.
## ***–û–ø–∏—Å–∞–Ω–∏–µ***
- –í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PySpark, Clickhouse, PostgreSQL –∏ Ariflow.
- –û—Ç–¥–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—Ä–∞–∑ airflow-with-java –∏–∑ DockerFile (Airflow –∏ PySpark)
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –∏–∑ docker-comose.yml
- –§–∞–π–ª ```russian_houses.csv``` –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ –≤–Ω–µ—à–Ω–µ–π —Å—Å—ã–ª–∫–µ https://disk.yandex.ru/d/HZ08UBRlxoCJTg

–í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏:
	1) –í—ã–≤–æ–¥ –≤–µ—Ä—Å–∏–π Clickhouse –∏ PostgreSQL –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
	2) –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ 
	3) –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞ –≤ DataFrame
	4) –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö
	5) –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ DataFrame –±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤ –ø–æ –≥–æ–¥—É
	6) –í—ã—á–∏—Å–ª–µ–Ω–∏–µ  —Å—Ä–µ–¥–Ω–µ–≥–æ –∏ –º–µ–¥–∏–∞–Ω–Ω–æ–≥–æ –≥–æ–¥–∞ –∑–¥–∞–Ω–∏–π
	7) –í—ã–≤–æ–¥ —Ç–æ–ø-10 —Ä–µ–≥–∏–æ–Ω–æ–≤(–≥–æ—Ä–æ–¥–æ–≤) —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ–±—ä–µ–∫—Ç–æ–≤
	8) –ü–æ–∏—Å–∫ –∑–¥–∞–Ω–∏–π —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥—å—é –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞
	9) –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–¥–∞–Ω–∏–π –ø–æ –¥–µ—Å—è—Ç–∏–ª–µ—Ç—è–º  (1960-—Ö, 1970-—Ö –∏ —Ç.–¥.)
	10) –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞ –≤ Clickhouse (ENGINE=MergeTree)
	11) –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ DataFrame –≤ —Ç–∞–±–ª–∏—Ü—É Clickhouse
	12) –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ø 25 –¥–æ–º–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø–ª–æ—â–∞–¥—å –±–æ–ª—å—à–µ 60 –∫–≤.–º.
	
–ì—Ä–∞—Ñ –≤ Airflow –∏—Å–ø–æ–ª–Ω–µ–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥–µ: 
			```  task_query_clickhouse    task_query_postgres   task_load_csvfile task_csvetl```
		     ```–í—ã–≤–æ–¥ –≤–µ—Ä—Å–∏–∏ Clickhouse –í—ã–≤–æ–¥ –≤–µ—Ä—Å–∏–∏ PostgreSQL   –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞  –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞```

![–ì—Ä–∞—Ñ](/DAG.png)			 

## ***üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞***

### <u>1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</u>
```git remote add origin git@github.com:nimeroff/FinalTaskBuildings.git```

### <u>2. –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é DomovoyBotTG</u>
```cd FinalTaskBuildings```

### <u>3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ </u>
```1. config```
```2. dags```
```3. logs```
```4. plugins```
```5. Dockerfile```
```6. docker-compose.yml```
```7. README.md```
```8. requirements.txt```
```9. .gitignore```

### <u>4. –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–∑–∞ airflow —Å–æ spark</u>
```docker build -t airflow-with-java```

### <u>5. –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤</u>
docker-compose up --build

### <u>6. –í—Ö–æ–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é web-—Å—Ç—Ä–∞–Ω–∏—Ü—É airflow</u>
```http://localhost:8080````
```–õ–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å: airflow```

### <u>7. –ó–∞–ø—É—Å–∫ –∑–∞–¥–∞—á–∏ DAG –≤ airflow</u>
```dags main (dags/main.py –≤ –ø—Ä–æ–µ–∫—Ç–µ)```

### <u>8. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ Python-–ø—Ä–æ–µ–∫—Ç–µ</u>
```pip3 install -r requirements.txt```

<!--–æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–æ–≤-->
### <u>9. –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–æ–≤</u>
| –ù–∞–∑–≤–∞–Ω–∏–µ                                         | –û–ø–∏—Å–∞–Ω–∏–µ                                                                              |
|--------------------------------------------------|---------------------------------------------------------------------------------------|
| Add function load_file and etl_CSV               | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ –∏ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á–∏ airflow              |
| Modified task BashOperator, add link to file csv | –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ bash –≤ —Ä–∞–º–∫–∞—Ö task                              |
| Add 'print top 25 house' to last task            | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è "–¢–æ–ø 25 –¥–æ–º–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø–ª–æ—â–∞–¥—å –±–æ–ª—å—à–µ 60" –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–¥–∞—á–∏ |
| Update REadme.md                                 | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ README.md                                                                  | 
| Add new script min max square                    | –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –Ω–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –≤—ã–≤–æ–¥–∞ –∑–¥–∞–Ω–∏–π —Å –º–∞–∫—Å. –∏ –º–∏–Ω. –ø–ª–æ—â–∞–¥—å—é –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º, –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–µ–Ω—å—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ, —Å—Ç–∞—Ä—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–∫–æ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω |
| Modified srcipt '–¢–æ–ø 10 —Ä–µ–≥–∏–æ–Ω–æ–≤ —Å –Ω–∞–∏–±. –∫–æ–ª. –æ–±—ä–µ–∫—Ç–æ–≤', –≤—ã–±–æ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –∏–∑ df_filter –∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ df_topten | df_filter - –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤ |
| –£–±—Ä–∞–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ jar –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è PSTGRSQL –∏–∑ Dockerfile, –¥–æ–±–∞–≤–ª–µ–Ω–∞ matplotlib==3.10.3 –≤ requirements.txt | –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–∞ –¥–ª—è –¥–æ—Å—Å—Ç—É–ø–∞ –∫ PostrgreSQL –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è |
| Add create table topregion,minax_square_by_region_house, cnt_house_by_ten_years and download data from dataframes | –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –≤ Clickhouse |
| Add function Diag. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –ø–æ 10 —Ä–µ–≥–∏–æ–Ω–∞–º —Å –Ω–∞–∏–± –∫–æ–ª. –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –ª–∏–Ω–µ–π–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è–º' | –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ png, –ø—É—Ç—å - /opt/airflow/dags/ |

### <u>10. –ó–∞–¥–∞–Ω–∏—è –∏ –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞</u>
1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –≤ DataFrame PySpark. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫

	<u>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π: 590708</u>

2. –í—ã—á–∏—Å–ª–∏—Ç–µ —Å—Ä–µ–¥–Ω–∏–π –∏ –º–µ–¥–∏–∞–Ω–Ω—ã–π –≥–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏ –∑–¥–∞–Ω–∏–π

	<u>–°—Ä–µ–¥–Ω–∏–π –≥–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏ 1972</u>

	<u>–ú–µ–¥–∏–∞–Ω–Ω—ã–π –≥–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏ 1972</u>

3. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç–æ–ø-10 –æ–±–ª–∞—Å—Ç–µ–π –∏ –≥–æ—Ä–æ–¥–æ–≤ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ–±—ä–µ–∫—Ç–æ–≤

	<u>–¢–æ–ø 10 —Ä–µ–≥–∏–æ–Ω–æ–≤-–æ–±–ª–∞—Å—Ç–µ–π —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ–±—ä–µ–∫—Ç–æ–≤</u>

| region             | cnt_house|
|--------------------|----------|
|  –ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å|    24616 |
|              –ú–æ—Å–∫–≤–∞|    21632 |
|–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å|    20329 |
|   –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π –∫—Ä–∞–π|    13646 |
|–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω|    13528 |
|–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª...|    13159 |
| –ö–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å|    11961 |
|   –ò—Ä–∫—É—Ç—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å|    10207 |
|  –†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å|     9942 |
|   –°–∞–º–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å|     9792 |

	<u>–°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –≤ clickhouse default.topregion</u> 
![–¢–æ–ø 10 —Ä–µ–≥–∏–æ–Ω–æ–≤-–æ–±–ª–∞—Å—Ç–µ–π —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ–±—ä–µ–∫—Ç–æ–≤](/dags/topregion.png)

4. –ù–∞–π–¥–∏—Ç–µ –∑–¥–∞–Ω–∏—è —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥—å—é –≤ —Ä–∞–º–∫–∞—Ö –∫–∞–∂–¥–æ–π –æ–±–ª–∞—Å—Ç–∏

	<u>–ó–¥–∞–Ω–∏—è —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥—å—é –≤ —Ä–∞–º–∫–∞—Ö –∫–∞–∂–¥–æ–π –æ–±–ª–∞—Å—Ç–∏</u>

|              region|sign|house_id|             address|  square|
|--------------------|----|--------|--------------------|--------|
|              –ê–ª–º–∞—Ç—ã| MIN|  422315|–¥. –≥ –ù–∞–≤–∞—à–∏–Ω–æ —É–ª ...|  457.08|
|              –ê–ª–º–∞—Ç—ã| MAX|  178967|—É–ª. –û—Ä–¥–∂–æ–Ω–∏–∫–∏–¥–∑–µ,...|  3403.0|
|      –ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π| MIN|  101877| —É–ª. –í–∏—Ç–µ–±—Å–∫–∞—è, –¥. 2|    3.26|
|      –ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π| MAX|  100084|—É–ª. –ü–∞–ø–∞–Ω–∏–Ω—Ü–µ–≤, –¥...| 88871.7|
|    –ê–º—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MIN|  106374|–ø–µ—Ä. –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã...|    26.6|
|    –ê–º—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MAX|  109584|–ø–≥—Ç. –§–µ–≤—Ä–∞–ª—å—Å–∫, —É...|429720.0|
|–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª...| MIN|  115194|–¥. –°–∏–¥–æ—Ä–æ–≤—Å–∫–∞—è, –¥. 1|    22.0|
|–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª...| MAX|  111115|—É–ª. –í–æ—Å–∫—Ä–µ—Å–µ–Ω—Å–∫–∞—è...| 25568.1|
|–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MIN|  123781|—É–ª. –õ–∏–º–∞–Ω—Å–∫–∞—è, –¥....|    55.9|
|–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MAX|  124304|—É–ª. –°.–ü–µ—Ä–æ–≤—Å–∫–æ–π, ...| 15026.0|
|–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MIN|  126864|—É–ª. –ú–æ–ª–æ–¥–µ–∂–Ω–∞—è, –¥...|    40.7|
|–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MAX|  129335|–º–∫—Ä. –ö–æ—Ä–æ–ª–µ–≤–∞, –¥. 32|35545.44|
|    –ë—Ä—è–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MIN|  134552|  —É–ª. –®–µ–≤—á–µ–Ω–∫–æ, –¥. 7|    25.9|
|    –ë—Ä—è–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MAX|  132198|—É–ª. –ö—Ä–∞—Å–Ω–æ–∞—Ä–º–µ–π—Å–∫...| 40764.3|
|–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MIN|  145482|  —É–ª. –ß–∞–ø–∞–µ–≤–∞, –¥. 1–ë|    3.01|
|–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MAX|  142545|–ø—Ä-–∫—Ç. –û–∫—Ç—è–±—Ä—å—Å–∫–∏...| 26959.0|
|–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª...| MIN|  156173|—É–ª. –∏–º –¶–∏–æ–ª–∫–æ–≤—Å–∫–æ...|    6.73|
|–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª...| MAX|  151717|—É–ª. –∏–º –ö–∞–ª–∏–Ω–∏–Ω–∞, ...| 47018.0|
| –í–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MIN|  164803| —É–ª. –ú–∏–ª—é—Ç–∏–Ω–∞, –¥. 17|    1.71|
| –í–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å| MAX|  164033|–ø—Ä-–∫—Ç. –®–µ–∫—Å–Ω–∏–Ω—Å–∫–∏...| 30924.0|

	<u>–°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –≤ clickhouse default.minax_square_by_region_house</u> 

5. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–¥–∞–Ω–∏–π –ø–æ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–∫–æ–ª—å–∫–æ –∑–¥–∞–Ω–∏–π –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ –≤ 1950-—Ö, 1960-—Ö –∏ —Ç.–¥.)
<u>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–¥–∞–Ω–∏–π –ø–æ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è–º</u>

|mod_year|cnt_build|
|--------|---------|
|    1960|    95062|
|    1970|    84543|
|    1980|    78441|
|    1950|    68321|
|    1990|    37091|
|    2000|    19740|
|    1940|    15703|
|    2010|     9895|
|    1930|     9834|
|    1920|     3563|
<u>–°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –≤ clickhouse default.cnt_house_by_ten_years</u> 
![–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–¥–∞–Ω–∏–π –ø–æ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è–º](/dags/decade_cnt_house.png)

6. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç –≤ Python, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç —Ç–æ–ø 25 –¥–æ–º–æ–≤ , —É –∫–æ—Ç–æ—Ä—ã—Ö –ø–ª–æ—â–∞–¥—å –±–æ–ª—å—à–µ 60 –∫–≤.–º (airflow) (—Ç–∞–±–ª–∏—Ü–∞ –≤ Clickhouse)

	<u>–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞ –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –≤—ã–±—Ä–æ—Å–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—É –≤ Clickhouse default.buildings</u>
	<u>–ù–∞ –æ—Å–Ω–æ–≤–µ —Ç–∞–±–ª–∏—Ü—ã default.buildings –æ—Å–Ω–æ–≤–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</u>

	<u>–¢–æ–ø 25 –¥–æ–º–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø–ª–æ—â–∞–¥—å –±–æ–ª—å—à–µ 60</u>

|house_id|             address|        square|
|--------|--------------------|--------------|
|  439756|—É–ª. –°–æ–ª–Ω–µ—á–Ω–∞—è 2-—è...|     3652010.0|
|   68482|–ø—Ä-–∫—Ç. –ü–æ–±–µ–¥—ã, –¥. 18|      646910.0|
|  301455|—Å. –§–∏–ª–∏–º–æ–Ω–æ–≤–æ, —É–ª...|      452520.0|
|  301442|—Å. –§–∏–ª–∏–º–æ–Ω–æ–≤–æ, —É–ª...|      448666.0|
|  301447|—Å. –§–∏–ª–∏–º–æ–Ω–æ–≤–æ, —É–ª...|      441713.0|
|  301457|—Å. –§–∏–ª–∏–º–æ–Ω–æ–≤–æ, —É–ª...|      441350.0|
|  109584|–ø–≥—Ç. –§–µ–≤—Ä–∞–ª—å—Å–∫, —É...|      429720.0|
|  351465|–ø–µ—Ä. –¢—Ä–µ—Ö–≥–æ—Ä–Ω—ã–π –ë...|      383408.0|
|  260554|—É–ª. –°–≤–µ—Ä–¥–ª–æ–≤–∞, –¥....|  313165.59375|
|  301445|—Å. –§–∏–ª–∏–º–æ–Ω–æ–≤–æ, —É–ª...|      270929.0|
|  520689|—É–ª. –ë–∞–Ω—ã–∫–∏–Ω–∞, –¥. 16–í|      259491.0|
|  301444|—Å. –§–∏–ª–∏–º–æ–Ω–æ–≤–æ, —É–ª...|      212432.0|
|  358459|—É–ª. –ú–∞—Ä—à–∞–ª–∞ –°–∞–≤–∏—Ü...|      202034.0|
|  172748| —É–ª. –£—Ä—ã–≤—Å–∫–æ–≥–æ, –¥. 9| 198476.703125|
|   55582|—É–ª. 40 –ª–µ—Ç –ü–æ–±–µ–¥—ã...|      197757.0|
|   18213|—É–ª. –†–∞—Å–∫–æ–ª—å–Ω–∏–∫–æ–≤–∞...|      194618.0|
|   10647|—É–ª. –®–µ–≤—á–µ–Ω–∫–æ, –¥. 154| 188873.296875|
|  301446|—Å. –§–∏–ª–∏–º–æ–Ω–æ–≤–æ, —É–ª...|      150655.0|
|  510872|–ø. –£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π...|      150000.0|
|  441961|  —É–ª. –ì–µ—Ä—Ü–µ–Ω–∞, –¥. 17|      132003.0|
|  301441|—Å. –§–∏–ª–∏–º–æ–Ω–æ–≤–æ, —É–ª...|      127871.0|
|  461518|  —É–ª. –õ–µ–æ–Ω–æ–≤–∞, –¥. 20|122261.1015625|
|  193782|     –º–∫—Ä. 9-–π, –¥. 85|121168.8984375|
|  359031|—É–ª. –†–∞–¥–∏–∞–ª—å–Ω–∞—è 6-...|      115452.5|
|  341134|–≥. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, —É–ª...| 115200.796875|

